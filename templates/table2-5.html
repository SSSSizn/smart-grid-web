<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中压线路负载率明细表</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="container-fluid mt-3">
        <h4 class="table-title mb-3">表2-5 中压线路负载率明细表</h4>

        <!-- 数据表格区域 -->
        <div class="table-container">
            <div id="loading" class="text-center my-5">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p>正在加载数据...</p>
            </div>

            <div id="errorMessage" class="alert alert-danger" style="display: none;"></div>

            <div id="tableContent" style="display: none;">
                <table class="table table-bordered table-hover table-striped">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>变电站名称</th>
                            <th>线路名称</th>
                            <th>限额电流（A）</th>
                            <th>2024年最大电流（A）</th>
                            <th>2024年线路最大负载率（%）</th>
                            <th>重载/轻载原因</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>

                <div class="mt-2">
                    <small class="text-muted">
                        说明：
                        <span style="color: #dc3545;">■ 红色背景</span>表示重载线路（负载率≥90%），
                        <span style="color: #198754;">■ 绿色背景</span>表示轻载线路（负载率≤25%）
                    </small>
                </div>

                <!-- 图表控制按钮 -->
                <div class="chart-controls mt-4">
                    <h5>数据可视化</h5>
                    <button id="showBarChart" class="btn btn-outline-primary me-2">
                        <i class="bi bi-bar-chart"></i> 柱状图
                    </button>
                    <button id="showPieChart" class="btn btn-outline-primary me-2">
                        <i class="bi bi-pie-chart"></i> 饼图
                    </button>
                    <button id="hideCharts" class="btn btn-outline-secondary" style="display: none;">
                        <i class="bi bi-eye-slash"></i> 隐藏图表
                    </button>
                </div>

                <!-- 图表容器 -->
                <div id="chartContainer" class="chart-container mt-4 text-center" style="display: none;">
                    <h6 id="chartTitle" class="text-center mb-3"></h6>
                    <canvas id="chartCanvas" style="display: inline-block;"></canvas>
                </div>
                <!-- 可编辑文字部分 -->
                <div class="page-control-panel" id="pagePanel" data-page-id="{{ page_id }}">
                    <h2>页面 {{ page_id }} - 查看 / 编辑</h2>

                    <div id="editableText">{{ text }}</div>

                    <br>
                    <div class="button-group">
                        <button id="editBtn" onclick="enableEdit()">编辑</button>
                        <button id="saveBtn" style="display: none;" onclick="saveText()">保存</button>
                        <button id="cancelBtn" style="display: none;" onclick="cancelEdit()">取消</button>
                        <button id="exportBtn" onclick="exportWord()">导出为 Word</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>